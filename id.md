# Introduction

The Mastercard ID Service (MIDS) platform is a digital identity service provided by [Mastercard International Inc.](https://www.mastercard.com) and its affiliates (Mastercard).  The service provides online identity verification and a reusable digital identity for consumers.  As part of this program, Mastercard aims to establish the `id` method for representing a user with a DID generated locally on the user's own device.  This specification details how DIDs under this method will be managed by Mastercard.  For more information, please see https://idservice.com

# Status of This Document

This is a draft document.  It may be periodically updated, replaced or removed by other documents at any time.

# Namespace Specific Identifier (NSI)

The Mastercard ID Service DID scheme is defined by the following ABNF:

```
idservice-did = "did:id:" idstring *(":" environment)
idstring = 21*22(base58char)
environment = ALPHA *(ALPHA / DIGIT / "_" / "-")
base58char = "1" / "2" / "3" / "4" / "5" / "6" / "7" / "8" / "9" / "A" / "B" / "C"
    / "D" / "E" / "F" / "G" / "H" / "J" / "K" / "L" / "M" / "N" / "P" / "Q"
    / "R" / "S" / "T" / "U" / "V" / "W" / "X" / "Y" / "Z" / "a" / "b" / "c"
    / "d" / "e" / "f" / "g" / "h" / "i" / "j" / "k" / "m" / "n" / "o" / "p"
    / "q" / "r" / "s" / "t" / "u" / "v" / "w" / "x" / "y" / "z"
```

The `idstring` is a v4 UUID as defined in RFC4122 that has been encoded as base-58 using the Bitcoin/IPFS hash alphabet.  This hash alphabet eliminates abiguity between certain alphanumeric characters (0 and O, l and 1) to improve readability.  This also means that the `idstring` itself is case-sensitive.

The `environment` string is *optional*, and used to bind DIDs to different operating environments as necessary.  This can be a simple string such as `test`.

Examples of valid `id` DIDs:

```
did:id:7g6x7Hdxbxf6CTCxiA4fNp
did:id:8b5aeoGeo4BszZroGthpHR:test
```

# CRUD Operations

The following operations are supported:

## Create

DIDs and DID documents are created via the enrollment process for ID service.  The service itself is primarily operated as a mobile application where identity material and corresponding keys are generated and stored on the device itself protected by the mobile device's Trusted Execution Environment (TEE).  Once enrollment is complete, a DID is generated by the user's device and may be submitted for registration in the Mastercard ID Service platform.

Any corresponding DID documents that are generated as a result of this registration process will be signed by device keys and verified by the Mastercard ID Service platform.

## Retrieve

A registered DID may be retrieved by an HTTP GET request against `https://idservice.com/did/{did}`.  This URL may change in future versions of this document as the service evolves.  The result of the query against either the ledger or the HTTP GET request is a DID document that matches the queried DID, if it exists.

## Update

DIDs themselves are immutable and cannot be updated.  However, as part of routine key rotation, it's possible that a DID document may be updated to reflect new signing keys.  Key rotation can happen in response to events such as a user request, or key expiration.  These updates will be made periodically as necessary to operate the platform and maintain compliance with Mastercard key rotation policies.

## Deactivate (Delete)

At a user's request, a DID document can be deactivated.  This request would be initiated from the Mastercard ID mobile app.  Once the request has been processed, Mastercard will unregister the DID with the Mastercard ID Service and remove DID documents associated with the DID.

# Security Considerations

This section provides the security consideration for the DID method implementation.

 - In case of a key compromise, the participant MUST deactivate existing DID immediately.
 - All communication MUST be encrypted using TLS 1.2 and above with 2048-bit key length supporting only secure cryptographic algorithms.
 - The DID controller server SHOULD be configured to only support strong cipher suites.
 - Any sensitive information SHOULD be shared through TLS and JWE encryption / message level encryption.
 - The DID controller MUST store the private key securely.
 - Developers of a DID controller SHOULD NOT write client applications that collect authentication information directly from users and should instead delegate this task to a trusted system component (for example, the system browser).
 - The DID controller MUST ensure that the application architecture is secure. The participant SHOULD implement necessary security controls to the application and implement an anti-fraud functionality.
 - When the DID controller invokes the DID method from a mobile application, the participant MUST ensure that the mobile application is obfuscated and signed using a trust certificate when available for public distribution.
 - The DID controller is responsible for generating and storing keys securely on cryptographic storage such as Hardware Security Module (HSM) in their infrastructure.
 - The DID controller MUST ensure that the application is periodically tested for security vulnerabilities and ensure that no exploitable vulnerabilities are present.
 - The DID controller SHOULD not use any vulnerable third-party libraries. The DID controller MUST ensure that the application code is scanned for security vulnerabilities and there are no open exploitable issues.
 - The DID controller SHOULD ensure that its application does not re-use the same cryptographic keys for multiple purposes.
 - The DID controller SHOULD implement rate limiting measures to ensure not to overload the platform.
 - The DID controller SHOULD implement security auditing.


# Privacy Considerations

This section provides the privacy consideration for the DID method implementation.

 - No user personal data are stored in a DID document.
 - The DID controller MUST ensure to protect integrity and confidentiality of user personal data. The DID controller MUST comply with all applicable privacy and data protection laws, regulations and principles.
 - If required, DID controller MUST ensure that necessary security controls are in place to protect user personal data.
 - The DID controller MUST ensure that no personal data is written on any system or application log.
 - The DID controller MUST ensure that application does not store any personal data in temporary memory.
