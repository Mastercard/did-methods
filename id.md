# Introduction

The Mastercard ID Service (MIDS) platform aims to provide online identity verification and a reusable digital identity for consumers.  As part of this program, Mastercard aims to establish `id` method for representing a user.  This specification details how DIDs under this method will be managed by Mastercard.

# Status of This Document

This is a draft document.  It may be periodically updated, replaced or removed by other documents at any time.

# Namespace Specific Identifier (NSI)

The Mastercard ID Service DID scheme is defined by the following ABNF:

```
idservice-did = "did:id:" idstring *(":" environment)
idstring = 21*22(base58char)
environment = ALPHA *(ALPHA / DIGIT / "_" / "-")
base58char = "1" / "2" / "3" / "4" / "5" / "6" / "7" / "8" / "9" / "A" / "B" / "C"
    / "D" / "E" / "F" / "G" / "H" / "J" / "K" / "L" / "M" / "N" / "P" / "Q"
    / "R" / "S" / "T" / "U" / "V" / "W" / "X" / "Y" / "Z" / "a" / "b" / "c"
    / "d" / "e" / "f" / "g" / "h" / "i" / "j" / "k" / "m" / "n" / "o" / "p"
    / "q" / "r" / "s" / "t" / "u" / "v" / "w" / "x" / "y" / "z"
```

The `idstring` is a v4 UUID as defined in RFC4122 that has been encoded as base-58 using the Bitcoin/IPFS hash alphabet.  This hash alphabet eliminates abiguity between certain alphanumeric characters (0 and O, l and 1) to improve readability.  This also means that the `idstring` itself is case-sensitive, regardless of the prefix requirements.

The `environment` string is *optional*, and used to bind DIDs to different operating environments as necessary.  This can be a simple string such as `test`.

Examples of valid `id` DIDs:

```
did:id:7g6x7Hdxbxf6CTCxiA4fNp
did:id:8b5aeoGeo4BszZroGthpHR:test
```

# CRUD Operations

The following operations are supported:

## Create

DIDs and DID documents are created via the enrollment process for ID service.  The service itself is primarily operated as a mobile application where identity material and corresponding keys are generated and stored on the device itself protected by the mobile device's Trusted Execution Environment (TEE).  Once enrollment is complete, a DID is generated by the Mastercard ID Service and registered for the user in the Mastercard ID Service platform.

Any corresponding DID documents that are generated as a result of this enrollment process will be signed by device keys and verified by the Mastercard ID Service platform before writing the document to a ledger.

## Retrieve

DIDs may be retrieved by querying the ledger directly, or by issuing an HTTP GET request against `https://idservice.com/did/{did}`.  This URL may change in future versions of this document as the service is better defined.  The result of the query against either the ledger or the HTTP GET request is a DID document that matches the queried DID, if it exists.

## Update

As part of routine key rotation, it's possible that a DID may be updated to reflect new signing keys.  Key rotation can happen in response to a user request, or key expiration.  These updates will be made periodically as necessary to operate the platform and maintain compliance with Mastercard key rotation policies.  Updates will be initiated from the Mastercard ID mobile application.

## Delete

At a user's request, a DID document can be completely deleted.  This request would be initiated from the Mastercard ID mobile app.  Once the request has been processed, Mastercard will delete the DID and any associated DID documents.

# Security Considerations

This section provides the security consideration for the DID method implementation.

 - In case of a key compromise, the participant MUST notify governance body and deactivate existing DID immediately.
 - All communication MUST be encrypted using TLS 1.2 and above with 2048-bit key length supporting only secure cryptographic algorithms.
 - The participant server SHOULD be configured to only support strong cipher suites.
 - Any sensitive information SHOULD be shared through TLS and JWE encryption / message level encryption.
 - In case of any security incident, the participant MUST inform governance body.
 - The participant MUST store the private key securely.
 - Participant developers SHOULD NOT write client applications that collect authentication information directly from users and should instead delegate this task to a trusted system component (for example, the system browser).
 - The participant MUST ensure that the application architecture is secure. The participant SHOULD implement necessary security controls to the application and implement an anti-fraud functionality.
 - When the participant invokes DID method from a mobile application, the participant MUST ensure that the mobile application is obfuscated and signed using a trust certificate when available for public distribution.
 - All communication from the participant MUST use OAUTH2 for API authentication with Mastercard ID Service platform. The participant is responsible for generating and storing keys securely on cryptographic storage such as Hardware Security Module (HSM) in their infrastructure.
 - The participant MUST ensure that the application is periodically tested for security vulnerabilities and ensure that there are no exploitable vulnerabilities are present.
 - The participant SHOULD not use any vulnerable third-party libraries. The participant MUST ensure that the application code is scanned for security vulnerabilities and there are no open exploitable issues.
 - The participant SHOULD ensure that its application does not re-use the same cryptographic keys for multiple purpose.
 - The participant SHOULD implement rate limiting measures to ensure not to overload the platform.
 - The participant SHOULD implement security auditing.


# Privacy Considerations

This section provides the privacy consideration for the DID method implementation.

 - No user personal data are stored on the registry.
 - The participant MUST ensure to protect integrity and confidentiality of user personal data. The participant MUST comply with all applicable privacy and data protection laws, regulations and principles.
 - The participant MUST ensure that there is no local storage of user personal data or any other sensitive information on a mobile device. If required, participant MUST ensure that necessary security controls are in place to protect user personal data.
 - The participant MUST ensure that no personal data is written on application log.
 - The participant MUST ensure that application does not store any personal data in temporary memory.
